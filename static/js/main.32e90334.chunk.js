(this["webpackJsonpgif-search"]=this["webpackJsonpgif-search"]||[]).push([[0],{32:function(e,t,a){e.exports=a(62)},37:function(e,t,a){},43:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(28),s=a.n(c),i=a(10),o=a(7),u=a(1);a(37);var l=function(e){var t=e.onSearch,a=Object(r.useState)(""),c=Object(o.a)(a,2),s=c[0],i=c[1];return n.a.createElement("form",{className:"search-form",onSubmit:function(e){e.preventDefault(),t(s),e.currentTarget.reset()}},n.a.createElement("label",{className:"is-hidden",htmlFor:"search"},"Search"),n.a.createElement("input",{type:"search",onChange:function(e){return i(e.target.value)},name:"search",placeholder:"Find gifs"}),n.a.createElement("button",{type:"submit",id:"submit",className:"search-button"},"Search"))},m=a(9),f=function(e){var t=e.setOffset,a=e.searchHistory;return n.a.createElement("div",{className:"history"},a.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",{className:"history__title"},"Recent searches:"),n.a.createElement("ul",{className:"history__list"},a.map((function(e,a){return n.a.createElement("li",{key:a,className:"history__item"},n.a.createElement(m.b,{to:e,onClick:function(){return t(0)}},e))})))))},h=(a(43),function(e){var t=e.performSearch,a=e.searchHistory,r=e.setOffset;return n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"inner header__inner"},n.a.createElement(l,{onSearch:t}),n.a.createElement(f,{searchHistory:a,setOffset:r})))}),g=n.a.forwardRef((function(e,t){var a=e.url,r=e.title;return n.a.createElement("li",{className:"gif-wrap"},n.a.createElement("img",{src:a,alt:r,ref:t}))})),b=function(e){var t=e.message;return n.a.createElement("li",{className:"no-gifs"},n.a.createElement("h3",null,t))},d=n.a.forwardRef((function(e,t){var a,r=e.data,c=e.error,s=e.loading;return r.length?a=r.map((function(e,a){return r.length===a+1?n.a.createElement(g,{ref:t,url:e.image,title:e.title,key:e.id+a}):n.a.createElement(g,{url:e.image,title:e.title,key:e.id+a})})):s||c||(a=n.a.createElement(b,{message:"Sorry, no GIFs match your search."})),n.a.createElement("ul",{className:"gif-list"},a)})),O=a(17),E=a.n(O),p=a(31),j=a(14),S=a.n(j),v=function(e,t){var a=Object(r.useState)(!0),n=Object(o.a)(a,2),c=n[0],s=n[1],l=Object(r.useState)(!1),m=Object(o.a)(l,2),f=m[0],h=m[1],g=Object(r.useState)(""),b=Object(o.a)(g,2),d=b[0],O=b[1],j=Object(r.useState)([]),v=Object(o.a)(j,2),y=v[0],k=v[1],N=Object(r.useState)([]),w=Object(o.a)(N,2),_=w[0],C=w[1],I=Object(u.f)().search,T=Object(r.useCallback)(Object(p.a)(E.a.mark((function e(){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),h(!1),r=I||"doggo",0===t&&k([]),S()({method:"GET",url:"https://api.giphy.com/v1/gifs/search",params:{q:r,offset:t,limit:50,api_key:"".concat("COqensqusgX63rW0V9QiIS3aC1286GSW")},cancelToken:new S.a.CancelToken((function(e){return a=e}))}).then((function(e){k((function(t){return[].concat(Object(i.a)(t),Object(i.a)(e.data.data.map((function(e){return{id:e.id,image:e.images.fixed_height.url,title:e.title}}))))})),C(e.data.pagination.total_count>e.data.pagination.count+e.data.pagination.offset),s(!1)})).catch((function(e){if(!S.a.isCancel(e)){"Request failed with status code 429"===e.message&&O("Too many gif requests in a short time, sorry. Take a break and come back."),h(!0)}})),e.abrupt("return",(function(){return a()}));case 6:case"end":return e.stop()}}),e)}))),[I,t]);return Object(r.useEffect)((function(){T()}),[I,e,T,t]),{loading:c,error:f,errorMessage:d,data:y,hasMore:_}},y=function(){var e=Object(u.e)(),t=localStorage.getItem("gifSearches"),a=Object(r.useState)(""),c=Object(o.a)(a,2),s=c[0],l=c[1],m=Object(r.useState)(0),f=Object(o.a)(m,2),g=f[0],O=f[1],E=Object(r.useState)(t?t.split(","):[]),p=Object(o.a)(E,2),j=p[0],S=p[1],y=v(s,g),k=y.data,N=y.hasMore,w=y.loading,_=y.error,C=y.errorMessage,I=Object(r.useRef)(),T=Object(r.useCallback)((function(e){w||(I.current&&I.current.disconnect(),I.current=new IntersectionObserver((function(e){e[0].isIntersecting&&N&&O((function(e){return e+50}))})),e&&I.current.observe(e))}),[w,N]);Object(r.useEffect)((function(){localStorage.setItem("gifSearches",j)}),[j]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(h,{performSearch:function(t){var a=t.trim();a&&(l(a),O(0),S((function(e){return Object(i.a)(new Set([a].concat(Object(i.a)(e.slice(0,5)))))})),e.push(a))},searchHistory:j,setOffset:O}),n.a.createElement("main",{className:"main-content"},n.a.createElement(d,{data:k,error:_,loading:w,ref:T}),w&&!_&&n.a.createElement(b,{message:"Loading..."}),_&&n.a.createElement(b,{message:"Error! ".concat(C)})))};s.a.render(n.a.createElement(m.a,{basename:"/Infinite-Gifs"},n.a.createElement(u.a,{path:"/:search?",component:y})),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.32e90334.chunk.js.map