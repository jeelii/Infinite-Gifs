{"version":3,"sources":["Components/SearchForm.js","Components/SearchHistory.js","Components/Header.js","Components/Gif.js","Components/NoGifs.js","Components/GifList.js","Components/useFetch.js","Components/utilities/getParam.js","Components/App.js","index.js"],"names":["SearchForm","onSearch","useState","searchText","setSearchText","className","onSubmit","e","preventDefault","currentTarget","reset","htmlFor","type","onChange","target","value","name","placeholder","id","SearchHistory","setOffset","searchHistory","length","map","word","idx","key","to","onClick","Header","performSearch","Gif","React","forwardRef","ref","url","title","src","alt","NoGifs","message","GifList","gifs","data","error","gif","image","useFetch","query","offset","loading","setLoading","setError","errorMessage","setErrorMessage","setData","hasMore","setHasMore","location","useLocation","sendQuery","useCallback","a","parameterName","search","locationParam","URLSearchParams","get","searchTerm","axios","method","params","q","limit","api_key","process","cancelToken","CancelToken","c","cancel","then","res","prevGifs","images","fixed_height","pagination","total_count","count","catch","isCancel","useEffect","App","history","useHistory","oldSearches","localStorage","getItem","setQuery","split","setSearchHistory","observer","useRef","lastGifRef","node","current","disconnect","IntersectionObserver","entries","isIntersecting","prevOffset","observe","setItem","trimmedValue","trim","prevHistory","Set","slice","newPath","push","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.e1faa19c.chunk.js","sourcesContent":["import React, { useState } from 'react';\n\nfunction SearchForm({ onSearch }) {\n  const [searchText, setSearchText] = useState('');\n\n  const onSearchChange = (e) => setSearchText(e.target.value);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    onSearch(searchText);\n    e.currentTarget.reset();\n  };\n\n  return (\n    <form className='search-form' onSubmit={handleSubmit}>\n      <label className='is-hidden' htmlFor='search'>\n        Search\n      </label>\n      <input\n        type='search'\n        onChange={onSearchChange}\n        name='search'\n        placeholder='Find gifs'\n      />\n      <button type='submit' id='submit' className='search-button'>\n        Search\n      </button>\n    </form>\n  );\n}\n\nexport default SearchForm;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst SearchHistory = ({ setOffset, searchHistory }) => {\n  return (\n    <div className='history'>\n      {searchHistory.length > 0 && (\n        <>\n          <h2 className='history__title'>Recent searches:</h2>\n          <ul className='history__list'>\n            {searchHistory.map((word, idx) => {\n              return (\n                <li key={idx} className='history__item'>\n                  <Link to={`?search=${word}`} onClick={() => setOffset(0)}>\n                    {word}\n                  </Link>\n                </li>\n              );\n            })}\n          </ul>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SearchHistory;\n","import React from 'react';\nimport SearchForm from './SearchForm';\nimport SearchHistory from './SearchHistory';\nimport './styles/Header.css';\n\nconst Header = ({ performSearch, searchHistory, setOffset }) => {\n  return (\n    <header className='header'>\n      <div className='inner header__inner'>\n        <SearchForm onSearch={performSearch} />\n        <SearchHistory searchHistory={searchHistory} setOffset={setOffset} />\n      </div>\n    </header>\n  );\n};\n\nexport default Header;\n","import React from 'react';\n\nconst Gif = React.forwardRef(({ url, title }, ref) => {\n  return (\n    <li className='gif-wrap'>\n      <img src={url} alt={title} ref={ref} />\n    </li>\n  );\n});\n\nexport default Gif;\n","import React from 'react';\n\nconst NoGifs = ({ message }) => (\n  <li className='no-gifs'>\n    <h3>{message}</h3>\n  </li>\n);\n\nexport default NoGifs;\n","import React from 'react';\nimport Gif from './Gif';\nimport NoGifs from './NoGifs';\n\nconst GifList = React.forwardRef(({ data, error }, ref) => {\n  let gifs;\n  const noGifsMessage = 'Sorry, no GIFs match your search.';\n  if (data.length) {\n    gifs = data.map((gif, idx) => {\n      if (data.length === idx + 1) {\n        return (\n          <Gif ref={ref} url={gif.image} title={gif.title} key={gif.id + idx} />\n        );\n      } else {\n        return <Gif url={gif.image} title={gif.title} key={gif.id + idx} />;\n      }\n    });\n  } else {\n    gifs = <NoGifs message={noGifsMessage} />;\n  }\n\n  return <ul className='gif-list'>{!error && gifs}</ul>;\n});\n\nexport default GifList;\n","import { useState, useEffect, useCallback } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport getParam from './utilities/getParam';\n\nconst useFetch = (query, offset) => {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [data, setData] = useState([]);\n  const [hasMore, setHasMore] = useState([]);\n\n  const location = useLocation();\n\n  const sendQuery = useCallback(async () => {\n    setLoading(true);\n    setError(false);\n    let cancel;\n    const locationParam = getParam('search', location.search);\n    const searchTerm = locationParam ? locationParam : 'doggo';\n    if (offset === 0) setData([]);\n    axios({\n      method: 'GET',\n      url: 'https://api.giphy.com/v1/gifs/search',\n      params: {\n        q: searchTerm,\n        offset: offset,\n        limit: 50,\n        api_key: `${process.env.REACT_APP_API_KEY}`,\n      },\n      cancelToken: new axios.CancelToken((c) => (cancel = c)),\n    })\n      .then((res) => {\n        setData((prevGifs) => {\n          return [\n            ...prevGifs,\n            ...res.data.data.map((gif) => {\n              return {\n                id: gif.id,\n                image: gif.images.fixed_height.url,\n                title: gif.title,\n              };\n            }),\n          ];\n        });\n        setHasMore(\n          res.data.pagination.total_count >\n            res.data.pagination.count + res.data.pagination.offset\n        );\n        setLoading(false);\n      })\n      .catch((e) => {\n        if (axios.isCancel(e)) return;\n        const giphyTooManyReqsMsg = 'Request failed with status code 429';\n        if (e.message === giphyTooManyReqsMsg)\n          setErrorMessage(\n            'Too many gif requests in a short time, sorry. Take a break and come back.'\n          );\n        setError(true);\n      });\n    return () => cancel();\n  }, [location, offset]);\n\n  useEffect(() => {\n    sendQuery();\n  }, [location, query, sendQuery, offset]);\n\n  return { loading, error, errorMessage, data, hasMore };\n};\n\nexport default useFetch;\n","export default (parameterName, url) => {\n  const urlParams = new URLSearchParams(url);\n  return urlParams.get(parameterName);\n};","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport './styles/App.css';\n\nimport Header from './Header';\nimport GifList from './GifList';\nimport NoGifs from './NoGifs';\n\nimport useFetch from './useFetch';\n\nconst App = () => {\n  const history = useHistory();\n  const location = useLocation();\n\n  const oldSearches = localStorage.getItem('gifSearches');\n\n  const [query, setQuery] = useState('');\n  const [offset, setOffset] = useState(0);\n  const [searchHistory, setSearchHistory] = useState(\n    oldSearches ? oldSearches.split(',') : []\n  );\n\n  const { data, hasMore, loading, error, errorMessage } = useFetch(\n    query,\n    offset\n  );\n\n  const observer = useRef();\n  const lastGifRef = useCallback(\n    (node) => {\n      if (loading) return;\n      if (observer.current) observer.current.disconnect();\n      observer.current = new IntersectionObserver((entries) => {\n        if (entries[0].isIntersecting && hasMore) {\n          setOffset((prevOffset) => prevOffset + 50);\n        }\n      });\n      if (node) observer.current.observe(node);\n    },\n    [loading, hasMore]\n  );\n\n  useEffect(() => {\n    localStorage.setItem('gifSearches', searchHistory);\n  }, [searchHistory]);\n\n  const performSearch = (value) => {\n    const trimmedValue = value.trim();\n    if (!trimmedValue) return;\n    setQuery(trimmedValue);\n    setOffset(0);\n    setSearchHistory((prevHistory) => {\n      return [...new Set([trimmedValue, ...prevHistory.slice(0, 5)])];\n    });\n    const newPath = `?search=${trimmedValue}`;\n    if (location.search !== newPath) {\n      history.push(newPath);\n    }\n    return;\n  };\n\n  return (\n    <>\n      <Header\n        performSearch={performSearch}\n        searchHistory={searchHistory}\n        setOffset={setOffset}\n      />\n      <main className='main-content'>\n        <GifList data={data} error={error} ref={lastGifRef} />\n        {loading && <p>Loading...</p>}\n        {error && <NoGifs message={<>Error! {errorMessage}</>} />}\n      </main>\n    </>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './Components/App';\nimport { BrowserRouter as Router } from 'react-router-dom';\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}